<!DOCTYPE html>
<html lang="en">
<!-- ... (your head and body content remains the same) ... -->

<!-- Find the SCRIPT tag at the very bottom of the file -->
<script>
    // --- (keep your existing toggleMobileMenu function) ---
    function toggleMobileMenu() {
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenu.classList.toggle('hidden');
    }

    // --- NEW JAVASCRIPT LOGIC ---

    // Find the form and the results container
    const assessmentForm = document.getElementById('assessment-form'); // Add id="assessment-form" to your <form> tag
    const resultsContainer = document.getElementById('results-container'); // Add id="results-container" to a div where you want results
    const submitButton = document.getElementById('submit-button'); // Add id="submit-button" to your form's submit button

    assessmentForm.addEventListener('submit', async function(event) {
        event.preventDefault(); // Prevents the page from reloading

        // Show loading state
        submitButton.disabled = true;
        submitButton.textContent = 'Analyzing...';
        resultsContainer.innerHTML = '<p class="text-center">Please wait while our AI analyzes your profile...</p>';

        // Get form data
        const formData = {
            age: parseInt(document.getElementById('age').value), // Add id="age" to your age input
            income: parseInt(document.getElementById('income').value), // Add id="income" to your income input
            goals: document.getElementById('goals').value, // Add id="goals" to your goals textarea
            current_investments: document.getElementById('investments').value, // Add id="investments" to your investments textarea
        };

        // This is the URL of your live backend running on Render.
        const apiUrl = 'https://your-backend-name.onrender.com/api/analyze'; // <-- IMPORTANT: REPLACE THIS URL

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(formData),
            });

            if (!response.ok) {
                throw new Error('Network response was not ok.');
            }

            const data = await response.json();
            const insight = data.insight;

            // Dynamically create and display the results
            resultsContainer.innerHTML = `
                <h2 class="text-2xl font-bold text-center mb-4">Your Personalized Insight</h2>
                <p class="text-center text-text-secondary mb-6"><strong>${insight.summary}</strong></p>
                <div class="space-y-4">
                    <div class="insight-card opportunity">
                        <h3>üí° Opportunity Identified</h3>
                        <p>${insight.opportunity}</p>
                    </div>
                    <div class="insight-card risk">
                        <h3>üõ°Ô∏è Risk Assessment</h3>
                        <p>${insight.risk_assessment}</p>
                    </div>
                    <div class="insight-card action">
                        <h3>‚ñ∂Ô∏è Suggested Action</h3>
                        <p>${insight.suggested_action}</p>
                    </div>
                </div>
            `;

        } catch (error) {
            resultsContainer.innerHTML = `<p class="text-center text-red-500">Error: Could not retrieve analysis. ${error.message}</p>`;
            console.error('Error fetching analysis:', error);
        } finally {
            // Restore button state
            submitButton.disabled = false;
            submitButton.textContent = 'Get My AI Insight';
        }
    });

</script>
</body>
</html>
